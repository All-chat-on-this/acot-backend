# ACOT后端功能实现详情

## 1. 用户与登录模块

### 1.1 用户管理
- 实现用户注册API
- 实现用户登录API，返回Access Token (JWT)
- 实现用户信息查询、修改API
- 实现密码加密存储（BCrypt）
- 实现Token生成与验证

### 1.2 第三方登录（JustAuth）
- 集成JustAuth框架
- 实现QQ登录回调处理
- 实现微信登录回调处理
- 实现第三方账号绑定与解绑API
- 自动创建新用户（首次第三方登录）

## 2. 配置管理与加密模块

### 2.1 配置管理
- 实现用户配置保存API
- 实现用户配置查询API
- 支持多配置模板并存
- 实现配置删除API

### 2.2 加密存储
- 实现AES对称加密算法
- 从环境变量读取加密密钥
- 对敏感信息进行加密（API Key等）
- 存储与读取时自动加解密

### 2.3 隐私保护
- 根据用户设置决定是否保存对话
- 根据用户设置决定是否保存思考文本
- 实现数据清除API

## 3. 对话管理模块

### 3.1 对话会话管理
- 实现创建会话API
- 实现会话列表查询API
- 实现会话重命名API
- 实现会话删除API

### 3.2 对话消息管理
- 实现消息保存API
- 实现消息查询API（分页）
- 实现消息删除API
- 支持消息的加密存储（可选）

### 3.3 搜索功能（Elasticsearch）
- 集成Elasticsearch
- 实现消息内容索引创建
- 实现关键词搜索API
- 实现多条件组合搜索
- 支持按用户ID过滤搜索结果

## 4. API调用与自定义请求/响应模块

### 4.1 API转发功能
- 实现通用API转发接口
- 支持各种HTTP方法（GET/POST等）
- 支持自定义请求头
- 支持代理设置

### 4.2 请求模板处理
- 根据用户配置构建请求体
- 注入对话上下文
- 处理角色、文本等字段映射

### 4.3 响应解析
- 根据用户配置解析响应
- 提取角色文本、思考文本等关键字段
- 错误处理与重试机制

## 5. 导入/导出模块

### 5.1 导出功能
- 实现对话记录导出API
- 实现配置导出API
- 实现全量数据导出API
- 导出前解密敏感数据

### 5.2 导入功能
- 实现JSON导入API
- 导入前进行数据格式校验
- 导入时提供覆盖/追加选项
- 导入后进行数据加密

## 6. 技术架构

### 6.1 后端框架
- 基于Spring Boot 3+构建
- 使用MyBatis Plus进行ORM
- 采用JDK 21

### 6.2 数据库
- MySQL数据库设计与优化
- 索引优化
- 连接池配置

### 6.3 搜索引擎
- Elasticsearch集成
- 索引设计与管理
- 中文分词配置（IK分词器）

### 6.4 安全
- Spring Security配置
- 跨域处理
- 防止XSS/CSRF攻击
- 敏感数据加密

### 6.5 性能与扩展
- API响应缓存策略
- 异步处理机制
- 服务监控与日志
